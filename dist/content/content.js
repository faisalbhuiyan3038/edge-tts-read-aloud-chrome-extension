/*! For license information please see content.js.LICENSE.txt */
(()=>{var t={804:t=>{var e={unlikelyCandidates:/-ad-|ai2html|banner|breadcrumbs|combx|comment|community|cover-wrap|disqus|extra|footer|gdpr|header|legends|menu|related|remark|replies|rss|shoutbox|sidebar|skyscraper|social|sponsor|supplemental|ad-break|agegate|pagination|pager|popup|yom-remote/i,okMaybeItsACandidate:/and|article|body|column|content|main|shadow/i};function i(t){return(!t.style||"none"!=t.style.display)&&!t.hasAttribute("hidden")&&(!t.hasAttribute("aria-hidden")||"true"!=t.getAttribute("aria-hidden")||t.className&&t.className.indexOf&&-1!==t.className.indexOf("fallback-image"))}t.exports=function(t,n={}){"function"==typeof n&&(n={visibilityChecker:n});var r={minScore:20,minContentLength:140,visibilityChecker:i};n=Object.assign(r,n);var o=t.querySelectorAll("p, pre, article"),s=t.querySelectorAll("div > br");if(s.length){var a=new Set(o);[].forEach.call(s,(function(t){a.add(t.parentNode)})),o=Array.from(a)}var l=0;return[].some.call(o,(function(t){if(!n.visibilityChecker(t))return!1;var i=t.className+" "+t.id;if(e.unlikelyCandidates.test(i)&&!e.okMaybeItsACandidate.test(i))return!1;if(t.matches("li p"))return!1;var r=t.textContent.trim().length;return!(r<n.minContentLength)&&(l+=Math.sqrt(r-n.minContentLength))>n.minScore}))}},238:t=>{function e(t,e){if(e&&e.documentElement)t=e,e=arguments[2];else if(!t||!t.documentElement)throw new Error("First argument to Readability constructor should be a document object.");if(e=e||{},this._doc=t,this._docJSDOMParser=this._doc.firstChild.__JSDOMParser__,this._articleTitle=null,this._articleByline=null,this._articleDir=null,this._articleSiteName=null,this._attempts=[],this._debug=!!e.debug,this._maxElemsToParse=e.maxElemsToParse||this.DEFAULT_MAX_ELEMS_TO_PARSE,this._nbTopCandidates=e.nbTopCandidates||this.DEFAULT_N_TOP_CANDIDATES,this._charThreshold=e.charThreshold||this.DEFAULT_CHAR_THRESHOLD,this._classesToPreserve=this.CLASSES_TO_PRESERVE.concat(e.classesToPreserve||[]),this._keepClasses=!!e.keepClasses,this._serializer=e.serializer||function(t){return t.innerHTML},this._disableJSONLD=!!e.disableJSONLD,this._allowedVideoRegex=e.allowedVideoRegex||this.REGEXPS.videos,this._flags=this.FLAG_STRIP_UNLIKELYS|this.FLAG_WEIGHT_CLASSES|this.FLAG_CLEAN_CONDITIONALLY,this._debug){let t=function(t){if(t.nodeType==t.TEXT_NODE)return`${t.nodeName} ("${t.textContent}")`;let e=Array.from(t.attributes||[],(function(t){return`${t.name}="${t.value}"`})).join(" ");return`<${t.localName} ${e}>`};this.log=function(){if("undefined"!=typeof console){let e=Array.from(arguments,(e=>e&&e.nodeType==this.ELEMENT_NODE?t(e):e));e.unshift("Reader: (Readability)"),console.log.apply(console,e)}else if("undefined"!=typeof dump){var e=Array.prototype.map.call(arguments,(function(e){return e&&e.nodeName?t(e):e})).join(" ");dump("Reader: (Readability) "+e+"\n")}}}else this.log=function(){}}e.prototype={FLAG_STRIP_UNLIKELYS:1,FLAG_WEIGHT_CLASSES:2,FLAG_CLEAN_CONDITIONALLY:4,ELEMENT_NODE:1,TEXT_NODE:3,DEFAULT_MAX_ELEMS_TO_PARSE:0,DEFAULT_N_TOP_CANDIDATES:5,DEFAULT_TAGS_TO_SCORE:"section,h2,h3,h4,h5,h6,p,td,pre".toUpperCase().split(","),DEFAULT_CHAR_THRESHOLD:500,REGEXPS:{unlikelyCandidates:/-ad-|ai2html|banner|breadcrumbs|combx|comment|community|cover-wrap|disqus|extra|footer|gdpr|header|legends|menu|related|remark|replies|rss|shoutbox|sidebar|skyscraper|social|sponsor|supplemental|ad-break|agegate|pagination|pager|popup|yom-remote/i,okMaybeItsACandidate:/and|article|body|column|content|main|shadow/i,positive:/article|body|content|entry|hentry|h-entry|main|page|pagination|post|text|blog|story/i,negative:/-ad-|hidden|^hid$| hid$| hid |^hid |banner|combx|comment|com-|contact|foot|footer|footnote|gdpr|masthead|media|meta|outbrain|promo|related|scroll|share|shoutbox|sidebar|skyscraper|sponsor|shopping|tags|tool|widget/i,extraneous:/print|archive|comment|discuss|e[\-]?mail|share|reply|all|login|sign|single|utility/i,byline:/byline|author|dateline|writtenby|p-author/i,replaceFonts:/<(\/?)font[^>]*>/gi,normalize:/\s{2,}/g,videos:/\/\/(www\.)?((dailymotion|youtube|youtube-nocookie|player\.vimeo|v\.qq)\.com|(archive|upload\.wikimedia)\.org|player\.twitch\.tv)/i,shareElements:/(\b|_)(share|sharedaddy)(\b|_)/i,nextLink:/(next|weiter|continue|>([^\|]|$)|»([^\|]|$))/i,prevLink:/(prev|earl|old|new|<|«)/i,tokenize:/\W+/g,whitespace:/^\s*$/,hasContent:/\S$/,hashUrl:/^#.+/,srcsetUrl:/(\S+)(\s+[\d.]+[xw])?(\s*(?:,|$))/g,b64DataUrl:/^data:\s*([^\s;,]+)\s*;\s*base64\s*,/i,commas:/\u002C|\u060C|\uFE50|\uFE10|\uFE11|\u2E41|\u2E34|\u2E32|\uFF0C/g,jsonLdArticleTypes:/^Article|AdvertiserContentArticle|NewsArticle|AnalysisNewsArticle|AskPublicNewsArticle|BackgroundNewsArticle|OpinionNewsArticle|ReportageNewsArticle|ReviewNewsArticle|Report|SatiricalArticle|ScholarlyArticle|MedicalScholarlyArticle|SocialMediaPosting|BlogPosting|LiveBlogPosting|DiscussionForumPosting|TechArticle|APIReference$/},UNLIKELY_ROLES:["menu","menubar","complementary","navigation","alert","alertdialog","dialog"],DIV_TO_P_ELEMS:new Set(["BLOCKQUOTE","DL","DIV","IMG","OL","P","PRE","TABLE","UL"]),ALTER_TO_DIV_EXCEPTIONS:["DIV","ARTICLE","SECTION","P"],PRESENTATIONAL_ATTRIBUTES:["align","background","bgcolor","border","cellpadding","cellspacing","frame","hspace","rules","style","valign","vspace"],DEPRECATED_SIZE_ATTRIBUTE_ELEMS:["TABLE","TH","TD","HR","PRE"],PHRASING_ELEMS:["ABBR","AUDIO","B","BDO","BR","BUTTON","CITE","CODE","DATA","DATALIST","DFN","EM","EMBED","I","IMG","INPUT","KBD","LABEL","MARK","MATH","METER","NOSCRIPT","OBJECT","OUTPUT","PROGRESS","Q","RUBY","SAMP","SCRIPT","SELECT","SMALL","SPAN","STRONG","SUB","SUP","TEXTAREA","TIME","VAR","WBR"],CLASSES_TO_PRESERVE:["page"],HTML_ESCAPE_MAP:{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"},_postProcessContent:function(t){this._fixRelativeUris(t),this._simplifyNestedElements(t),this._keepClasses||this._cleanClasses(t)},_removeNodes:function(t,e){if(this._docJSDOMParser&&t._isLiveNodeList)throw new Error("Do not pass live node lists to _removeNodes");for(var i=t.length-1;i>=0;i--){var n=t[i],r=n.parentNode;r&&(e&&!e.call(this,n,i,t)||r.removeChild(n))}},_replaceNodeTags:function(t,e){if(this._docJSDOMParser&&t._isLiveNodeList)throw new Error("Do not pass live node lists to _replaceNodeTags");for(const i of t)this._setNodeTag(i,e)},_forEachNode:function(t,e){Array.prototype.forEach.call(t,e,this)},_findNode:function(t,e){return Array.prototype.find.call(t,e,this)},_someNode:function(t,e){return Array.prototype.some.call(t,e,this)},_everyNode:function(t,e){return Array.prototype.every.call(t,e,this)},_concatNodeLists:function(){var t=Array.prototype.slice,e=t.call(arguments).map((function(e){return t.call(e)}));return Array.prototype.concat.apply([],e)},_getAllNodesWithTag:function(t,e){return t.querySelectorAll?t.querySelectorAll(e.join(",")):[].concat.apply([],e.map((function(e){var i=t.getElementsByTagName(e);return Array.isArray(i)?i:Array.from(i)})))},_cleanClasses:function(t){var e=this._classesToPreserve,i=(t.getAttribute("class")||"").split(/\s+/).filter((function(t){return-1!=e.indexOf(t)})).join(" ");for(i?t.setAttribute("class",i):t.removeAttribute("class"),t=t.firstElementChild;t;t=t.nextElementSibling)this._cleanClasses(t)},_fixRelativeUris:function(t){var e=this._doc.baseURI,i=this._doc.documentURI;function n(t){if(e==i&&"#"==t.charAt(0))return t;try{return new URL(t,e).href}catch(t){}return t}var r=this._getAllNodesWithTag(t,["a"]);this._forEachNode(r,(function(t){var e=t.getAttribute("href");if(e)if(0===e.indexOf("javascript:"))if(1===t.childNodes.length&&t.childNodes[0].nodeType===this.TEXT_NODE){var i=this._doc.createTextNode(t.textContent);t.parentNode.replaceChild(i,t)}else{for(var r=this._doc.createElement("span");t.firstChild;)r.appendChild(t.firstChild);t.parentNode.replaceChild(r,t)}else t.setAttribute("href",n(e))}));var o=this._getAllNodesWithTag(t,["img","picture","figure","video","audio","source"]);this._forEachNode(o,(function(t){var e=t.getAttribute("src"),i=t.getAttribute("poster"),r=t.getAttribute("srcset");if(e&&t.setAttribute("src",n(e)),i&&t.setAttribute("poster",n(i)),r){var o=r.replace(this.REGEXPS.srcsetUrl,(function(t,e,i,r){return n(e)+(i||"")+r}));t.setAttribute("srcset",o)}}))},_simplifyNestedElements:function(t){for(var e=t;e;){if(e.parentNode&&["DIV","SECTION"].includes(e.tagName)&&(!e.id||!e.id.startsWith("readability"))){if(this._isElementWithoutContent(e)){e=this._removeAndGetNext(e);continue}if(this._hasSingleTagInsideElement(e,"DIV")||this._hasSingleTagInsideElement(e,"SECTION")){for(var i=e.children[0],n=0;n<e.attributes.length;n++)i.setAttribute(e.attributes[n].name,e.attributes[n].value);e.parentNode.replaceChild(i,e),e=i;continue}}e=this._getNextNode(e)}},_getArticleTitle:function(){var t=this._doc,e="",i="";try{"string"!=typeof(e=i=t.title.trim())&&(e=i=this._getInnerText(t.getElementsByTagName("title")[0]))}catch(t){}var n=!1;function r(t){return t.split(/\s+/).length}if(/ [\|\-\\\/>»] /.test(e))n=/ [\\\/>»] /.test(e),r(e=i.replace(/(.*)[\|\-\\\/>»] .*/gi,"$1"))<3&&(e=i.replace(/[^\|\-\\\/>»]*[\|\-\\\/>»](.*)/gi,"$1"));else if(-1!==e.indexOf(": ")){var o=this._concatNodeLists(t.getElementsByTagName("h1"),t.getElementsByTagName("h2")),s=e.trim();this._someNode(o,(function(t){return t.textContent.trim()===s}))||(r(e=i.substring(i.lastIndexOf(":")+1))<3?e=i.substring(i.indexOf(":")+1):r(i.substr(0,i.indexOf(":")))>5&&(e=i))}else if(e.length>150||e.length<15){var a=t.getElementsByTagName("h1");1===a.length&&(e=this._getInnerText(a[0]))}var l=r(e=e.trim().replace(this.REGEXPS.normalize," "));return l<=4&&(!n||l!=r(i.replace(/[\|\-\\\/>»]+/g,""))-1)&&(e=i),e},_prepDocument:function(){var t=this._doc;this._removeNodes(this._getAllNodesWithTag(t,["style"])),t.body&&this._replaceBrs(t.body),this._replaceNodeTags(this._getAllNodesWithTag(t,["font"]),"SPAN")},_nextNode:function(t){for(var e=t;e&&e.nodeType!=this.ELEMENT_NODE&&this.REGEXPS.whitespace.test(e.textContent);)e=e.nextSibling;return e},_replaceBrs:function(t){this._forEachNode(this._getAllNodesWithTag(t,["br"]),(function(t){for(var e=t.nextSibling,i=!1;(e=this._nextNode(e))&&"BR"==e.tagName;){i=!0;var n=e.nextSibling;e.parentNode.removeChild(e),e=n}if(i){var r=this._doc.createElement("p");for(t.parentNode.replaceChild(r,t),e=r.nextSibling;e;){if("BR"==e.tagName){var o=this._nextNode(e.nextSibling);if(o&&"BR"==o.tagName)break}if(!this._isPhrasingContent(e))break;var s=e.nextSibling;r.appendChild(e),e=s}for(;r.lastChild&&this._isWhitespace(r.lastChild);)r.removeChild(r.lastChild);"P"===r.parentNode.tagName&&this._setNodeTag(r.parentNode,"DIV")}}))},_setNodeTag:function(t,e){if(this.log("_setNodeTag",t,e),this._docJSDOMParser)return t.localName=e.toLowerCase(),t.tagName=e.toUpperCase(),t;for(var i=t.ownerDocument.createElement(e);t.firstChild;)i.appendChild(t.firstChild);t.parentNode.replaceChild(i,t),t.readability&&(i.readability=t.readability);for(var n=0;n<t.attributes.length;n++)try{i.setAttribute(t.attributes[n].name,t.attributes[n].value)}catch(t){}return i},_prepArticle:function(t){this._cleanStyles(t),this._markDataTables(t),this._fixLazyImages(t),this._cleanConditionally(t,"form"),this._cleanConditionally(t,"fieldset"),this._clean(t,"object"),this._clean(t,"embed"),this._clean(t,"footer"),this._clean(t,"link"),this._clean(t,"aside");var e=this.DEFAULT_CHAR_THRESHOLD;this._forEachNode(t.children,(function(t){this._cleanMatchedNodes(t,(function(t,i){return this.REGEXPS.shareElements.test(i)&&t.textContent.length<e}))})),this._clean(t,"iframe"),this._clean(t,"input"),this._clean(t,"textarea"),this._clean(t,"select"),this._clean(t,"button"),this._cleanHeaders(t),this._cleanConditionally(t,"table"),this._cleanConditionally(t,"ul"),this._cleanConditionally(t,"div"),this._replaceNodeTags(this._getAllNodesWithTag(t,["h1"]),"h2"),this._removeNodes(this._getAllNodesWithTag(t,["p"]),(function(t){return 0===t.getElementsByTagName("img").length+t.getElementsByTagName("embed").length+t.getElementsByTagName("object").length+t.getElementsByTagName("iframe").length&&!this._getInnerText(t,!1)})),this._forEachNode(this._getAllNodesWithTag(t,["br"]),(function(t){var e=this._nextNode(t.nextSibling);e&&"P"==e.tagName&&t.parentNode.removeChild(t)})),this._forEachNode(this._getAllNodesWithTag(t,["table"]),(function(t){var e=this._hasSingleTagInsideElement(t,"TBODY")?t.firstElementChild:t;if(this._hasSingleTagInsideElement(e,"TR")){var i=e.firstElementChild;if(this._hasSingleTagInsideElement(i,"TD")){var n=i.firstElementChild;n=this._setNodeTag(n,this._everyNode(n.childNodes,this._isPhrasingContent)?"P":"DIV"),t.parentNode.replaceChild(n,t)}}}))},_initializeNode:function(t){switch(t.readability={contentScore:0},t.tagName){case"DIV":t.readability.contentScore+=5;break;case"PRE":case"TD":case"BLOCKQUOTE":t.readability.contentScore+=3;break;case"ADDRESS":case"OL":case"UL":case"DL":case"DD":case"DT":case"LI":case"FORM":t.readability.contentScore-=3;break;case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"TH":t.readability.contentScore-=5}t.readability.contentScore+=this._getClassWeight(t)},_removeAndGetNext:function(t){var e=this._getNextNode(t,!0);return t.parentNode.removeChild(t),e},_getNextNode:function(t,e){if(!e&&t.firstElementChild)return t.firstElementChild;if(t.nextElementSibling)return t.nextElementSibling;do{t=t.parentNode}while(t&&!t.nextElementSibling);return t&&t.nextElementSibling},_textSimilarity:function(t,e){var i=t.toLowerCase().split(this.REGEXPS.tokenize).filter(Boolean),n=e.toLowerCase().split(this.REGEXPS.tokenize).filter(Boolean);return i.length&&n.length?1-n.filter((t=>!i.includes(t))).join(" ").length/n.join(" ").length:0},_checkByline:function(t,e){if(this._articleByline)return!1;if(void 0!==t.getAttribute)var i=t.getAttribute("rel"),n=t.getAttribute("itemprop");return!(!("author"===i||n&&-1!==n.indexOf("author")||this.REGEXPS.byline.test(e))||!this._isValidByline(t.textContent)||(this._articleByline=t.textContent.trim(),0))},_getNodeAncestors:function(t,e){e=e||0;for(var i=0,n=[];t.parentNode&&(n.push(t.parentNode),!e||++i!==e);)t=t.parentNode;return n},_grabArticle:function(t){this.log("**** grabArticle ****");var e=this._doc,i=null!==t;if(!(t=t||this._doc.body))return this.log("No body found in document. Abort."),null;for(var n=t.innerHTML;;){this.log("Starting grabArticle loop");var r=this._flagIsActive(this.FLAG_STRIP_UNLIKELYS),o=[],s=this._doc.documentElement;let X=!0;for(;s;){"HTML"===s.tagName&&(this._articleLang=s.getAttribute("lang"));var a=s.className+" "+s.id;if(this._isProbablyVisible(s))if("true"!=s.getAttribute("aria-modal")||"dialog"!=s.getAttribute("role"))if(this._checkByline(s,a))s=this._removeAndGetNext(s);else if(X&&this._headerDuplicatesTitle(s))this.log("Removing header: ",s.textContent.trim(),this._articleTitle.trim()),X=!1,s=this._removeAndGetNext(s);else{if(r){if(this.REGEXPS.unlikelyCandidates.test(a)&&!this.REGEXPS.okMaybeItsACandidate.test(a)&&!this._hasAncestorTag(s,"table")&&!this._hasAncestorTag(s,"code")&&"BODY"!==s.tagName&&"A"!==s.tagName){this.log("Removing unlikely candidate - "+a),s=this._removeAndGetNext(s);continue}if(this.UNLIKELY_ROLES.includes(s.getAttribute("role"))){this.log("Removing content with role "+s.getAttribute("role")+" - "+a),s=this._removeAndGetNext(s);continue}}if("DIV"!==s.tagName&&"SECTION"!==s.tagName&&"HEADER"!==s.tagName&&"H1"!==s.tagName&&"H2"!==s.tagName&&"H3"!==s.tagName&&"H4"!==s.tagName&&"H5"!==s.tagName&&"H6"!==s.tagName||!this._isElementWithoutContent(s)){if(-1!==this.DEFAULT_TAGS_TO_SCORE.indexOf(s.tagName)&&o.push(s),"DIV"===s.tagName){for(var l=null,h=s.firstChild;h;){var c=h.nextSibling;if(this._isPhrasingContent(h))null!==l?l.appendChild(h):this._isWhitespace(h)||(l=e.createElement("p"),s.replaceChild(l,h),l.appendChild(h));else if(null!==l){for(;l.lastChild&&this._isWhitespace(l.lastChild);)l.removeChild(l.lastChild);l=null}h=c}if(this._hasSingleTagInsideElement(s,"P")&&this._getLinkDensity(s)<.25){var u=s.children[0];s.parentNode.replaceChild(u,s),s=u,o.push(s)}else this._hasChildBlockElement(s)||(s=this._setNodeTag(s,"P"),o.push(s))}s=this._getNextNode(s)}else s=this._removeAndGetNext(s)}else s=this._removeAndGetNext(s);else this.log("Removing hidden node - "+a),s=this._removeAndGetNext(s)}var f=[];this._forEachNode(o,(function(t){if(t.parentNode&&void 0!==t.parentNode.tagName){var e=this._getInnerText(t);if(!(e.length<25)){var i=this._getNodeAncestors(t,5);if(0!==i.length){var n=0;n+=1,n+=e.split(this.REGEXPS.commas).length,n+=Math.min(Math.floor(e.length/100),3),this._forEachNode(i,(function(t,e){if(t.tagName&&t.parentNode&&void 0!==t.parentNode.tagName){if(void 0===t.readability&&(this._initializeNode(t),f.push(t)),0===e)var i=1;else i=1===e?2:3*e;t.readability.contentScore+=n/i}}))}}}}));for(var d=[],g=0,p=f.length;g<p;g+=1){var m=f[g],y=m.readability.contentScore*(1-this._getLinkDensity(m));m.readability.contentScore=y,this.log("Candidate:",m,"with score "+y);for(var _=0;_<this._nbTopCandidates;_++){var b=d[_];if(!b||y>b.readability.contentScore){d.splice(_,0,m),d.length>this._nbTopCandidates&&d.pop();break}}}var E,N=d[0]||null,T=!1;if(null===N||"BODY"===N.tagName){for(N=e.createElement("DIV"),T=!0;t.firstChild;)this.log("Moving child out:",t.firstChild),N.appendChild(t.firstChild);t.appendChild(N),this._initializeNode(N)}else if(N){for(var v=[],A=1;A<d.length;A++)d[A].readability.contentScore/N.readability.contentScore>=.75&&v.push(this._getNodeAncestors(d[A]));if(v.length>=3)for(E=N.parentNode;"BODY"!==E.tagName;){for(var w=0,S=0;S<v.length&&w<3;S++)w+=Number(v[S].includes(E));if(w>=3){N=E;break}E=E.parentNode}N.readability||this._initializeNode(N),E=N.parentNode;for(var C=N.readability.contentScore,I=C/3;"BODY"!==E.tagName;)if(E.readability){var L=E.readability.contentScore;if(L<I)break;if(L>C){N=E;break}C=E.readability.contentScore,E=E.parentNode}else E=E.parentNode;for(E=N.parentNode;"BODY"!=E.tagName&&1==E.children.length;)E=(N=E).parentNode;N.readability||this._initializeNode(N)}var x=e.createElement("DIV");i&&(x.id="readability-content");for(var R=Math.max(10,.2*N.readability.contentScore),B=(E=N.parentNode).children,O=0,P=B.length;O<P;O++){var U=B[O],D=!1;if(this.log("Looking at sibling node:",U,U.readability?"with score "+U.readability.contentScore:""),this.log("Sibling has score",U.readability?U.readability.contentScore:"Unknown"),U===N)D=!0;else{var M=0;if(U.className===N.className&&""!==N.className&&(M+=.2*N.readability.contentScore),U.readability&&U.readability.contentScore+M>=R)D=!0;else if("P"===U.nodeName){var k=this._getLinkDensity(U),F=this._getInnerText(U),G=F.length;(G>80&&k<.25||G<80&&G>0&&0===k&&-1!==F.search(/\.( |$)/))&&(D=!0)}}D&&(this.log("Appending node:",U),-1===this.ALTER_TO_DIV_EXCEPTIONS.indexOf(U.nodeName)&&(this.log("Altering sibling:",U,"to div."),U=this._setNodeTag(U,"DIV")),x.appendChild(U),B=E.children,O-=1,P-=1)}if(this._debug&&this.log("Article content pre-prep: "+x.innerHTML),this._prepArticle(x),this._debug&&this.log("Article content post-prep: "+x.innerHTML),T)N.id="readability-page-1",N.className="page";else{var H=e.createElement("DIV");for(H.id="readability-page-1",H.className="page";x.firstChild;)H.appendChild(x.firstChild);x.appendChild(H)}this._debug&&this.log("Article content after paging: "+x.innerHTML);var $=!0,j=this._getInnerText(x,!0).length;if(j<this._charThreshold)if($=!1,t.innerHTML=n,this._flagIsActive(this.FLAG_STRIP_UNLIKELYS))this._removeFlag(this.FLAG_STRIP_UNLIKELYS),this._attempts.push({articleContent:x,textLength:j});else if(this._flagIsActive(this.FLAG_WEIGHT_CLASSES))this._removeFlag(this.FLAG_WEIGHT_CLASSES),this._attempts.push({articleContent:x,textLength:j});else if(this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY))this._removeFlag(this.FLAG_CLEAN_CONDITIONALLY),this._attempts.push({articleContent:x,textLength:j});else{if(this._attempts.push({articleContent:x,textLength:j}),this._attempts.sort((function(t,e){return e.textLength-t.textLength})),!this._attempts[0].textLength)return null;x=this._attempts[0].articleContent,$=!0}if($){var W=[E,N].concat(this._getNodeAncestors(E));return this._someNode(W,(function(t){if(!t.tagName)return!1;var e=t.getAttribute("dir");return!!e&&(this._articleDir=e,!0)})),x}}},_isValidByline:function(t){return("string"==typeof t||t instanceof String)&&(t=t.trim()).length>0&&t.length<100},_unescapeHtmlEntities:function(t){if(!t)return t;var e=this.HTML_ESCAPE_MAP;return t.replace(/&(quot|amp|apos|lt|gt);/g,(function(t,i){return e[i]})).replace(/&#(?:x([0-9a-z]{1,4})|([0-9]{1,4}));/gi,(function(t,e,i){var n=parseInt(e||i,e?16:10);return String.fromCharCode(n)}))},_getJSONLD:function(t){var e,i=this._getAllNodesWithTag(t,["script"]);return this._forEachNode(i,(function(t){if(!e&&"application/ld+json"===t.getAttribute("type"))try{var i=t.textContent.replace(/^\s*<!\[CDATA\[|\]\]>\s*$/g,""),n=JSON.parse(i);if(!n["@context"]||!n["@context"].match(/^https?\:\/\/schema\.org$/))return;if(!n["@type"]&&Array.isArray(n["@graph"])&&(n=n["@graph"].find((function(t){return(t["@type"]||"").match(this.REGEXPS.jsonLdArticleTypes)}))),!n||!n["@type"]||!n["@type"].match(this.REGEXPS.jsonLdArticleTypes))return;if(e={},"string"==typeof n.name&&"string"==typeof n.headline&&n.name!==n.headline){var r=this._getArticleTitle(),o=this._textSimilarity(n.name,r)>.75,s=this._textSimilarity(n.headline,r)>.75;e.title=s&&!o?n.headline:n.name}else"string"==typeof n.name?e.title=n.name.trim():"string"==typeof n.headline&&(e.title=n.headline.trim());return n.author&&("string"==typeof n.author.name?e.byline=n.author.name.trim():Array.isArray(n.author)&&n.author[0]&&"string"==typeof n.author[0].name&&(e.byline=n.author.filter((function(t){return t&&"string"==typeof t.name})).map((function(t){return t.name.trim()})).join(", "))),"string"==typeof n.description&&(e.excerpt=n.description.trim()),n.publisher&&"string"==typeof n.publisher.name&&(e.siteName=n.publisher.name.trim()),void("string"==typeof n.datePublished&&(e.datePublished=n.datePublished.trim()))}catch(t){this.log(t.message)}})),e||{}},_getArticleMetadata:function(t){var e={},i={},n=this._doc.getElementsByTagName("meta"),r=/\s*(article|dc|dcterm|og|twitter)\s*:\s*(author|creator|description|published_time|title|site_name)\s*/gi,o=/^\s*(?:(dc|dcterm|og|twitter|weibo:(article|webpage))\s*[\.:]\s*)?(author|creator|description|title|site_name)\s*$/i;return this._forEachNode(n,(function(t){var e=t.getAttribute("name"),n=t.getAttribute("property"),s=t.getAttribute("content");if(s){var a=null,l=null;n&&(a=n.match(r))&&(l=a[0].toLowerCase().replace(/\s/g,""),i[l]=s.trim()),!a&&e&&o.test(e)&&(l=e,s&&(l=l.toLowerCase().replace(/\s/g,"").replace(/\./g,":"),i[l]=s.trim()))}})),e.title=t.title||i["dc:title"]||i["dcterm:title"]||i["og:title"]||i["weibo:article:title"]||i["weibo:webpage:title"]||i.title||i["twitter:title"],e.title||(e.title=this._getArticleTitle()),e.byline=t.byline||i["dc:creator"]||i["dcterm:creator"]||i.author,e.excerpt=t.excerpt||i["dc:description"]||i["dcterm:description"]||i["og:description"]||i["weibo:article:description"]||i["weibo:webpage:description"]||i.description||i["twitter:description"],e.siteName=t.siteName||i["og:site_name"],e.publishedTime=t.datePublished||i["article:published_time"]||null,e.title=this._unescapeHtmlEntities(e.title),e.byline=this._unescapeHtmlEntities(e.byline),e.excerpt=this._unescapeHtmlEntities(e.excerpt),e.siteName=this._unescapeHtmlEntities(e.siteName),e.publishedTime=this._unescapeHtmlEntities(e.publishedTime),e},_isSingleImage:function(t){return"IMG"===t.tagName||1===t.children.length&&""===t.textContent.trim()&&this._isSingleImage(t.children[0])},_unwrapNoscriptImages:function(t){var e=Array.from(t.getElementsByTagName("img"));this._forEachNode(e,(function(t){for(var e=0;e<t.attributes.length;e++){var i=t.attributes[e];switch(i.name){case"src":case"srcset":case"data-src":case"data-srcset":return}if(/\.(jpg|jpeg|png|webp)/i.test(i.value))return}t.parentNode.removeChild(t)}));var i=Array.from(t.getElementsByTagName("noscript"));this._forEachNode(i,(function(e){var i=t.createElement("div");if(i.innerHTML=e.innerHTML,this._isSingleImage(i)){var n=e.previousElementSibling;if(n&&this._isSingleImage(n)){var r=n;"IMG"!==r.tagName&&(r=n.getElementsByTagName("img")[0]);for(var o=i.getElementsByTagName("img")[0],s=0;s<r.attributes.length;s++){var a=r.attributes[s];if(""!==a.value&&("src"===a.name||"srcset"===a.name||/\.(jpg|jpeg|png|webp)/i.test(a.value))){if(o.getAttribute(a.name)===a.value)continue;var l=a.name;o.hasAttribute(l)&&(l="data-old-"+l),o.setAttribute(l,a.value)}}e.parentNode.replaceChild(i.firstElementChild,n)}}}))},_removeScripts:function(t){this._removeNodes(this._getAllNodesWithTag(t,["script","noscript"]))},_hasSingleTagInsideElement:function(t,e){return 1==t.children.length&&t.children[0].tagName===e&&!this._someNode(t.childNodes,(function(t){return t.nodeType===this.TEXT_NODE&&this.REGEXPS.hasContent.test(t.textContent)}))},_isElementWithoutContent:function(t){return t.nodeType===this.ELEMENT_NODE&&0==t.textContent.trim().length&&(0==t.children.length||t.children.length==t.getElementsByTagName("br").length+t.getElementsByTagName("hr").length)},_hasChildBlockElement:function(t){return this._someNode(t.childNodes,(function(t){return this.DIV_TO_P_ELEMS.has(t.tagName)||this._hasChildBlockElement(t)}))},_isPhrasingContent:function(t){return t.nodeType===this.TEXT_NODE||-1!==this.PHRASING_ELEMS.indexOf(t.tagName)||("A"===t.tagName||"DEL"===t.tagName||"INS"===t.tagName)&&this._everyNode(t.childNodes,this._isPhrasingContent)},_isWhitespace:function(t){return t.nodeType===this.TEXT_NODE&&0===t.textContent.trim().length||t.nodeType===this.ELEMENT_NODE&&"BR"===t.tagName},_getInnerText:function(t,e){e=void 0===e||e;var i=t.textContent.trim();return e?i.replace(this.REGEXPS.normalize," "):i},_getCharCount:function(t,e){return e=e||",",this._getInnerText(t).split(e).length-1},_cleanStyles:function(t){if(t&&"svg"!==t.tagName.toLowerCase()){for(var e=0;e<this.PRESENTATIONAL_ATTRIBUTES.length;e++)t.removeAttribute(this.PRESENTATIONAL_ATTRIBUTES[e]);-1!==this.DEPRECATED_SIZE_ATTRIBUTE_ELEMS.indexOf(t.tagName)&&(t.removeAttribute("width"),t.removeAttribute("height"));for(var i=t.firstElementChild;null!==i;)this._cleanStyles(i),i=i.nextElementSibling}},_getLinkDensity:function(t){var e=this._getInnerText(t).length;if(0===e)return 0;var i=0;return this._forEachNode(t.getElementsByTagName("a"),(function(t){var e=t.getAttribute("href"),n=e&&this.REGEXPS.hashUrl.test(e)?.3:1;i+=this._getInnerText(t).length*n})),i/e},_getClassWeight:function(t){if(!this._flagIsActive(this.FLAG_WEIGHT_CLASSES))return 0;var e=0;return"string"==typeof t.className&&""!==t.className&&(this.REGEXPS.negative.test(t.className)&&(e-=25),this.REGEXPS.positive.test(t.className)&&(e+=25)),"string"==typeof t.id&&""!==t.id&&(this.REGEXPS.negative.test(t.id)&&(e-=25),this.REGEXPS.positive.test(t.id)&&(e+=25)),e},_clean:function(t,e){var i=-1!==["object","embed","iframe"].indexOf(e);this._removeNodes(this._getAllNodesWithTag(t,[e]),(function(t){if(i){for(var e=0;e<t.attributes.length;e++)if(this._allowedVideoRegex.test(t.attributes[e].value))return!1;if("object"===t.tagName&&this._allowedVideoRegex.test(t.innerHTML))return!1}return!0}))},_hasAncestorTag:function(t,e,i,n){i=i||3,e=e.toUpperCase();for(var r=0;t.parentNode;){if(i>0&&r>i)return!1;if(t.parentNode.tagName===e&&(!n||n(t.parentNode)))return!0;t=t.parentNode,r++}return!1},_getRowAndColumnCount:function(t){for(var e=0,i=0,n=t.getElementsByTagName("tr"),r=0;r<n.length;r++){var o=n[r].getAttribute("rowspan")||0;o&&(o=parseInt(o,10)),e+=o||1;for(var s=0,a=n[r].getElementsByTagName("td"),l=0;l<a.length;l++){var h=a[l].getAttribute("colspan")||0;h&&(h=parseInt(h,10)),s+=h||1}i=Math.max(i,s)}return{rows:e,columns:i}},_markDataTables:function(t){for(var e=t.getElementsByTagName("table"),i=0;i<e.length;i++){var n=e[i];if("presentation"!=n.getAttribute("role"))if("0"!=n.getAttribute("datatable"))if(n.getAttribute("summary"))n._readabilityDataTable=!0;else{var r=n.getElementsByTagName("caption")[0];if(r&&r.childNodes.length>0)n._readabilityDataTable=!0;else if(["col","colgroup","tfoot","thead","th"].some((function(t){return!!n.getElementsByTagName(t)[0]})))this.log("Data table because found data-y descendant"),n._readabilityDataTable=!0;else if(n.getElementsByTagName("table")[0])n._readabilityDataTable=!1;else{var o=this._getRowAndColumnCount(n);o.rows>=10||o.columns>4?n._readabilityDataTable=!0:n._readabilityDataTable=o.rows*o.columns>10}}else n._readabilityDataTable=!1;else n._readabilityDataTable=!1}},_fixLazyImages:function(t){this._forEachNode(this._getAllNodesWithTag(t,["img","picture","figure"]),(function(t){if(t.src&&this.REGEXPS.b64DataUrl.test(t.src)){if("image/svg+xml"===this.REGEXPS.b64DataUrl.exec(t.src)[1])return;for(var e=!1,i=0;i<t.attributes.length;i++){var n=t.attributes[i];if("src"!==n.name&&/\.(jpg|jpeg|png|webp)/i.test(n.value)){e=!0;break}}if(e){var r=t.src.search(/base64\s*/i)+7;t.src.length-r<133&&t.removeAttribute("src")}}if(!(t.src||t.srcset&&"null"!=t.srcset)||-1!==t.className.toLowerCase().indexOf("lazy"))for(var o=0;o<t.attributes.length;o++)if("src"!==(n=t.attributes[o]).name&&"srcset"!==n.name&&"alt"!==n.name){var s=null;if(/\.(jpg|jpeg|png|webp)\s+\d/.test(n.value)?s="srcset":/^\s*\S+\.(jpg|jpeg|png|webp)\S*\s*$/.test(n.value)&&(s="src"),s)if("IMG"===t.tagName||"PICTURE"===t.tagName)t.setAttribute(s,n.value);else if("FIGURE"===t.tagName&&!this._getAllNodesWithTag(t,["img","picture"]).length){var a=this._doc.createElement("img");a.setAttribute(s,n.value),t.appendChild(a)}}}))},_getTextDensity:function(t,e){var i=this._getInnerText(t,!0).length;if(0===i)return 0;var n=0,r=this._getAllNodesWithTag(t,e);return this._forEachNode(r,(t=>n+=this._getInnerText(t,!0).length)),n/i},_cleanConditionally:function(t,e){this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY)&&this._removeNodes(this._getAllNodesWithTag(t,[e]),(function(t){var i=function(t){return t._readabilityDataTable},n="ul"===e||"ol"===e;if(!n){var r=0,o=this._getAllNodesWithTag(t,["ul","ol"]);this._forEachNode(o,(t=>r+=this._getInnerText(t).length)),n=r/this._getInnerText(t).length>.9}if("table"===e&&i(t))return!1;if(this._hasAncestorTag(t,"table",-1,i))return!1;if(this._hasAncestorTag(t,"code"))return!1;var s=this._getClassWeight(t);if(this.log("Cleaning Conditionally",t),s+0<0)return!0;if(this._getCharCount(t,",")<10){for(var a=t.getElementsByTagName("p").length,l=t.getElementsByTagName("img").length,h=t.getElementsByTagName("li").length-100,c=t.getElementsByTagName("input").length,u=this._getTextDensity(t,["h1","h2","h3","h4","h5","h6"]),f=0,d=this._getAllNodesWithTag(t,["object","embed","iframe"]),g=0;g<d.length;g++){for(var p=0;p<d[g].attributes.length;p++)if(this._allowedVideoRegex.test(d[g].attributes[p].value))return!1;if("object"===d[g].tagName&&this._allowedVideoRegex.test(d[g].innerHTML))return!1;f++}var m=this._getLinkDensity(t),y=this._getInnerText(t).length,_=l>1&&a/l<.5&&!this._hasAncestorTag(t,"figure")||!n&&h>a||c>Math.floor(a/3)||!n&&u<.9&&y<25&&(0===l||l>2)&&!this._hasAncestorTag(t,"figure")||!n&&s<25&&m>.2||s>=25&&m>.5||1===f&&y<75||f>1;if(n&&_){for(var b=0;b<t.children.length;b++)if(t.children[b].children.length>1)return _;if(l==t.getElementsByTagName("li").length)return!1}return _}return!1}))},_cleanMatchedNodes:function(t,e){for(var i=this._getNextNode(t,!0),n=this._getNextNode(t);n&&n!=i;)n=e.call(this,n,n.className+" "+n.id)?this._removeAndGetNext(n):this._getNextNode(n)},_cleanHeaders:function(t){let e=this._getAllNodesWithTag(t,["h1","h2"]);this._removeNodes(e,(function(t){let e=this._getClassWeight(t)<0;return e&&this.log("Removing header with low class weight:",t),e}))},_headerDuplicatesTitle:function(t){if("H1"!=t.tagName&&"H2"!=t.tagName)return!1;var e=this._getInnerText(t,!1);return this.log("Evaluating similarity of header:",e,this._articleTitle),this._textSimilarity(this._articleTitle,e)>.75},_flagIsActive:function(t){return(this._flags&t)>0},_removeFlag:function(t){this._flags=this._flags&~t},_isProbablyVisible:function(t){return(!t.style||"none"!=t.style.display)&&(!t.style||"hidden"!=t.style.visibility)&&!t.hasAttribute("hidden")&&(!t.hasAttribute("aria-hidden")||"true"!=t.getAttribute("aria-hidden")||t.className&&t.className.indexOf&&-1!==t.className.indexOf("fallback-image"))},parse:function(){if(this._maxElemsToParse>0){var t=this._doc.getElementsByTagName("*").length;if(t>this._maxElemsToParse)throw new Error("Aborting parsing document; "+t+" elements found")}this._unwrapNoscriptImages(this._doc);var e=this._disableJSONLD?{}:this._getJSONLD(this._doc);this._removeScripts(this._doc),this._prepDocument();var i=this._getArticleMetadata(e);this._articleTitle=i.title;var n=this._grabArticle();if(!n)return null;if(this.log("Grabbed: "+n.innerHTML),this._postProcessContent(n),!i.excerpt){var r=n.getElementsByTagName("p");r.length>0&&(i.excerpt=r[0].textContent.trim())}var o=n.textContent;return{title:this._articleTitle,byline:i.byline||this._articleByline,dir:this._articleDir,lang:this._articleLang,content:this._serializer(n),textContent:o,length:o.length,excerpt:i.excerpt,siteName:i.siteName||this._articleSiteName,publishedTime:i.publishedTime}}},t.exports=e},396:(t,e,i)=>{var n=i(238),r=i(804);t.exports={Readability:n,isProbablyReaderable:r}},526:(t,e)=>{"use strict";e.byteLength=function(t){var e=a(t),i=e[0],n=e[1];return 3*(i+n)/4-n},e.toByteArray=function(t){var e,i,o=a(t),s=o[0],l=o[1],h=new r(function(t,e,i){return 3*(e+i)/4-i}(0,s,l)),c=0,u=l>0?s-4:s;for(i=0;i<u;i+=4)e=n[t.charCodeAt(i)]<<18|n[t.charCodeAt(i+1)]<<12|n[t.charCodeAt(i+2)]<<6|n[t.charCodeAt(i+3)],h[c++]=e>>16&255,h[c++]=e>>8&255,h[c++]=255&e;return 2===l&&(e=n[t.charCodeAt(i)]<<2|n[t.charCodeAt(i+1)]>>4,h[c++]=255&e),1===l&&(e=n[t.charCodeAt(i)]<<10|n[t.charCodeAt(i+1)]<<4|n[t.charCodeAt(i+2)]>>2,h[c++]=e>>8&255,h[c++]=255&e),h},e.fromByteArray=function(t){for(var e,n=t.length,r=n%3,o=[],s=16383,a=0,h=n-r;a<h;a+=s)o.push(l(t,a,a+s>h?h:a+s));return 1===r?(e=t[n-1],o.push(i[e>>2]+i[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],o.push(i[e>>10]+i[e>>4&63]+i[e<<2&63]+"=")),o.join("")};for(var i=[],n=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)i[s]=o[s],n[o.charCodeAt(s)]=s;function a(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return-1===i&&(i=e),[i,i===e?0:4-i%4]}function l(t,e,n){for(var r,o,s=[],a=e;a<n;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(i[(o=r)>>18&63]+i[o>>12&63]+i[o>>6&63]+i[63&o]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},287:(t,e,i)=>{"use strict";const n=i(526),r=i(251),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=l,e.SlowBuffer=function(t){return+t!=t&&(t=0),l.alloc(+t)},e.INSPECT_MAX_BYTES=50;const s=2147483647;function a(t){if(t>s)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,l.prototype),e}function l(t,e,i){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return u(t)}return h(t,e,i)}function h(t,e,i){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!l.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const i=0|p(t,e);let n=a(i);const r=n.write(t,e);return r!==i&&(n=n.slice(0,r)),n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(q(t,Uint8Array)){const e=new Uint8Array(t);return d(e.buffer,e.byteOffset,e.byteLength)}return f(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(q(t,ArrayBuffer)||t&&q(t.buffer,ArrayBuffer))return d(t,e,i);if("undefined"!=typeof SharedArrayBuffer&&(q(t,SharedArrayBuffer)||t&&q(t.buffer,SharedArrayBuffer)))return d(t,e,i);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return l.from(n,e,i);const r=function(t){if(l.isBuffer(t)){const e=0|g(t.length),i=a(e);return 0===i.length||t.copy(i,0,0,e),i}return void 0!==t.length?"number"!=typeof t.length||K(t.length)?a(0):f(t):"Buffer"===t.type&&Array.isArray(t.data)?f(t.data):void 0}(t);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return l.from(t[Symbol.toPrimitive]("string"),e,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return c(t),a(t<0?0:0|g(t))}function f(t){const e=t.length<0?0:0|g(t.length),i=a(e);for(let n=0;n<e;n+=1)i[n]=255&t[n];return i}function d(t,e,i){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(i||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===e&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,e):new Uint8Array(t,e,i),Object.setPrototypeOf(n,l.prototype),n}function g(t){if(t>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|t}function p(t,e){if(l.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||q(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const i=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===i)return 0;let r=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return V(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return z(t).length;default:if(r)return n?-1:V(t).length;e=(""+e).toLowerCase(),r=!0}}function m(t,e,i){let n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return x(this,e,i);case"utf8":case"utf-8":return S(this,e,i);case"ascii":return I(this,e,i);case"latin1":case"binary":return L(this,e,i);case"base64":return w(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function y(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}function _(t,e,i,n,r){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),K(i=+i)&&(i=r?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(r)return-1;i=t.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof e&&(e=l.from(e,n)),l.isBuffer(e))return 0===e.length?-1:b(t,e,i,n,r);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):b(t,[e],i,n,r);throw new TypeError("val must be string, number or Buffer")}function b(t,e,i,n,r){let o,s=1,a=t.length,l=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,l/=2,i/=2}function h(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(r){let n=-1;for(o=i;o<a;o++)if(h(t,o)===h(e,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===l)return n*s}else-1!==n&&(o-=o-n),n=-1}else for(i+l>a&&(i=a-l),o=i;o>=0;o--){let i=!0;for(let n=0;n<l;n++)if(h(t,o+n)!==h(e,n)){i=!1;break}if(i)return o}return-1}function E(t,e,i,n){i=Number(i)||0;const r=t.length-i;n?(n=Number(n))>r&&(n=r):n=r;const o=e.length;let s;for(n>o/2&&(n=o/2),s=0;s<n;++s){const n=parseInt(e.substr(2*s,2),16);if(K(n))return s;t[i+s]=n}return s}function N(t,e,i,n){return Y(V(e,t.length-i),t,i,n)}function T(t,e,i,n){return Y(function(t){const e=[];for(let i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,n)}function v(t,e,i,n){return Y(z(e),t,i,n)}function A(t,e,i,n){return Y(function(t,e){let i,n,r;const o=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)i=t.charCodeAt(s),n=i>>8,r=i%256,o.push(r),o.push(n);return o}(e,t.length-i),t,i,n)}function w(t,e,i){return 0===e&&i===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,i))}function S(t,e,i){i=Math.min(t.length,i);const n=[];let r=e;for(;r<i;){const e=t[r];let o=null,s=e>239?4:e>223?3:e>191?2:1;if(r+s<=i){let i,n,a,l;switch(s){case 1:e<128&&(o=e);break;case 2:i=t[r+1],128==(192&i)&&(l=(31&e)<<6|63&i,l>127&&(o=l));break;case 3:i=t[r+1],n=t[r+2],128==(192&i)&&128==(192&n)&&(l=(15&e)<<12|(63&i)<<6|63&n,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:i=t[r+1],n=t[r+2],a=t[r+3],128==(192&i)&&128==(192&n)&&128==(192&a)&&(l=(15&e)<<18|(63&i)<<12|(63&n)<<6|63&a,l>65535&&l<1114112&&(o=l))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),r+=s}return function(t){const e=t.length;if(e<=C)return String.fromCharCode.apply(String,t);let i="",n=0;for(;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=C));return i}(n)}e.kMaxLength=s,l.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(t,e,i){return h(t,e,i)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(t,e,i){return function(t,e,i){return c(t),t<=0?a(t):void 0!==e?"string"==typeof i?a(t).fill(e,i):a(t).fill(e):a(t)}(t,e,i)},l.allocUnsafe=function(t){return u(t)},l.allocUnsafeSlow=function(t){return u(t)},l.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==l.prototype},l.compare=function(t,e){if(q(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),q(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let i=t.length,n=e.length;for(let r=0,o=Math.min(i,n);r<o;++r)if(t[r]!==e[r]){i=t[r],n=e[r];break}return i<n?-1:n<i?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);let i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;const n=l.allocUnsafe(e);let r=0;for(i=0;i<t.length;++i){let e=t[i];if(q(e,Uint8Array))r+e.length>n.length?(l.isBuffer(e)||(e=l.from(e)),e.copy(n,r)):Uint8Array.prototype.set.call(n,e,r);else{if(!l.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,r)}r+=e.length}return n},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)y(this,e,e+1);return this},l.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},l.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},l.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?S(this,0,t):m.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){let t="";const i=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(t+=" ... "),"<Buffer "+t+">"},o&&(l.prototype[o]=l.prototype.inspect),l.prototype.compare=function(t,e,i,n,r){if(q(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),e<0||i>t.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&e>=i)return 0;if(n>=r)return-1;if(e>=i)return 1;if(this===t)return 0;let o=(r>>>=0)-(n>>>=0),s=(i>>>=0)-(e>>>=0);const a=Math.min(o,s),h=this.slice(n,r),c=t.slice(e,i);for(let t=0;t<a;++t)if(h[t]!==c[t]){o=h[t],s=c[t];break}return o<s?-1:s<o?1:0},l.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},l.prototype.indexOf=function(t,e,i){return _(this,t,e,i,!0)},l.prototype.lastIndexOf=function(t,e,i){return _(this,t,e,i,!1)},l.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(i)?(i>>>=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}const r=this.length-e;if((void 0===i||i>r)&&(i=r),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return E(this,t,e,i);case"utf8":case"utf-8":return N(this,t,e,i);case"ascii":case"latin1":case"binary":return T(this,t,e,i);case"base64":return v(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,e,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const C=4096;function I(t,e,i){let n="";i=Math.min(t.length,i);for(let r=e;r<i;++r)n+=String.fromCharCode(127&t[r]);return n}function L(t,e,i){let n="";i=Math.min(t.length,i);for(let r=e;r<i;++r)n+=String.fromCharCode(t[r]);return n}function x(t,e,i){const n=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>n)&&(i=n);let r="";for(let n=e;n<i;++n)r+=J[t[n]];return r}function R(t,e,i){const n=t.slice(e,i);let r="";for(let t=0;t<n.length-1;t+=2)r+=String.fromCharCode(n[t]+256*n[t+1]);return r}function B(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,i,n,r,o){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<o)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function P(t,e,i,n,r){$(e,n,r,t,i,7);let o=Number(e&BigInt(4294967295));t[i++]=o,o>>=8,t[i++]=o,o>>=8,t[i++]=o,o>>=8,t[i++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[i++]=s,s>>=8,t[i++]=s,s>>=8,t[i++]=s,s>>=8,t[i++]=s,i}function U(t,e,i,n,r){$(e,n,r,t,i,7);let o=Number(e&BigInt(4294967295));t[i+7]=o,o>>=8,t[i+6]=o,o>>=8,t[i+5]=o,o>>=8,t[i+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[i+3]=s,s>>=8,t[i+2]=s,s>>=8,t[i+1]=s,s>>=8,t[i]=s,i+8}function D(t,e,i,n,r,o){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function M(t,e,i,n,o){return e=+e,i>>>=0,o||D(t,0,i,4),r.write(t,e,i,n,23,4),i+4}function k(t,e,i,n,o){return e=+e,i>>>=0,o||D(t,0,i,8),r.write(t,e,i,n,52,8),i+8}l.prototype.slice=function(t,e){const i=this.length;(t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t);const n=this.subarray(t,e);return Object.setPrototypeOf(n,l.prototype),n},l.prototype.readUintLE=l.prototype.readUIntLE=function(t,e,i){t>>>=0,e>>>=0,i||B(t,e,this.length);let n=this[t],r=1,o=0;for(;++o<e&&(r*=256);)n+=this[t+o]*r;return n},l.prototype.readUintBE=l.prototype.readUIntBE=function(t,e,i){t>>>=0,e>>>=0,i||B(t,e,this.length);let n=this[t+--e],r=1;for(;e>0&&(r*=256);)n+=this[t+--e]*r;return n},l.prototype.readUint8=l.prototype.readUInt8=function(t,e){return t>>>=0,e||B(t,1,this.length),this[t]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(t,e){return t>>>=0,e||B(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(t,e){return t>>>=0,e||B(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(t,e){return t>>>=0,e||B(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(t,e){return t>>>=0,e||B(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readBigUInt64LE=Q((function(t){j(t>>>=0,"offset");const e=this[t],i=this[t+7];void 0!==e&&void 0!==i||W(t,this.length-8);const n=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,r=this[++t]+256*this[++t]+65536*this[++t]+i*2**24;return BigInt(n)+(BigInt(r)<<BigInt(32))})),l.prototype.readBigUInt64BE=Q((function(t){j(t>>>=0,"offset");const e=this[t],i=this[t+7];void 0!==e&&void 0!==i||W(t,this.length-8);const n=e*2**24+65536*this[++t]+256*this[++t]+this[++t],r=this[++t]*2**24+65536*this[++t]+256*this[++t]+i;return(BigInt(n)<<BigInt(32))+BigInt(r)})),l.prototype.readIntLE=function(t,e,i){t>>>=0,e>>>=0,i||B(t,e,this.length);let n=this[t],r=1,o=0;for(;++o<e&&(r*=256);)n+=this[t+o]*r;return r*=128,n>=r&&(n-=Math.pow(2,8*e)),n},l.prototype.readIntBE=function(t,e,i){t>>>=0,e>>>=0,i||B(t,e,this.length);let n=e,r=1,o=this[t+--n];for(;n>0&&(r*=256);)o+=this[t+--n]*r;return r*=128,o>=r&&(o-=Math.pow(2,8*e)),o},l.prototype.readInt8=function(t,e){return t>>>=0,e||B(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){t>>>=0,e||B(t,2,this.length);const i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt16BE=function(t,e){t>>>=0,e||B(t,2,this.length);const i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt32LE=function(t,e){return t>>>=0,e||B(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return t>>>=0,e||B(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readBigInt64LE=Q((function(t){j(t>>>=0,"offset");const e=this[t],i=this[t+7];void 0!==e&&void 0!==i||W(t,this.length-8);const n=this[t+4]+256*this[t+5]+65536*this[t+6]+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),l.prototype.readBigInt64BE=Q((function(t){j(t>>>=0,"offset");const e=this[t],i=this[t+7];void 0!==e&&void 0!==i||W(t,this.length-8);const n=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(n)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+i)})),l.prototype.readFloatLE=function(t,e){return t>>>=0,e||B(t,4,this.length),r.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return t>>>=0,e||B(t,4,this.length),r.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return t>>>=0,e||B(t,8,this.length),r.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return t>>>=0,e||B(t,8,this.length),r.read(this,t,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(t,e,i,n){t=+t,e>>>=0,i>>>=0,n||O(this,t,e,i,Math.pow(2,8*i)-1,0);let r=1,o=0;for(this[e]=255&t;++o<i&&(r*=256);)this[e+o]=t/r&255;return e+i},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(t,e,i,n){t=+t,e>>>=0,i>>>=0,n||O(this,t,e,i,Math.pow(2,8*i)-1,0);let r=i-1,o=1;for(this[e+r]=255&t;--r>=0&&(o*=256);)this[e+r]=t/o&255;return e+i},l.prototype.writeUint8=l.prototype.writeUInt8=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,1,255,0),this[e]=255&t,e+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},l.prototype.writeBigUInt64LE=Q((function(t,e=0){return P(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=Q((function(t,e=0){return U(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*i-1);O(this,t,e,i,n-1,-n)}let r=0,o=1,s=0;for(this[e]=255&t;++r<i&&(o*=256);)t<0&&0===s&&0!==this[e+r-1]&&(s=1),this[e+r]=(t/o|0)-s&255;return e+i},l.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*i-1);O(this,t,e,i,n-1,-n)}let r=i-1,o=1,s=0;for(this[e+r]=255&t;--r>=0&&(o*=256);)t<0&&0===s&&0!==this[e+r+1]&&(s=1),this[e+r]=(t/o|0)-s&255;return e+i},l.prototype.writeInt8=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},l.prototype.writeInt16BE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},l.prototype.writeInt32LE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},l.prototype.writeInt32BE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},l.prototype.writeBigInt64LE=Q((function(t,e=0){return P(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=Q((function(t,e=0){return U(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(t,e,i){return M(this,t,e,!0,i)},l.prototype.writeFloatBE=function(t,e,i){return M(this,t,e,!1,i)},l.prototype.writeDoubleLE=function(t,e,i){return k(this,t,e,!0,i)},l.prototype.writeDoubleBE=function(t,e,i){return k(this,t,e,!1,i)},l.prototype.copy=function(t,e,i,n){if(!l.isBuffer(t))throw new TypeError("argument should be a Buffer");if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);const r=n-i;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,i,n):Uint8Array.prototype.set.call(t,this.subarray(i,n),e),r},l.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){const e=t.charCodeAt(0);("utf8"===n&&e<128||"latin1"===n)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;let r;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(r=e;r<i;++r)this[r]=t;else{const o=l.isBuffer(t)?t:l.from(t,n),s=o.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(r=0;r<i-e;++r)this[r+e]=o[r%s]}return this};const F={};function G(t,e,i){F[t]=class extends i{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function H(t){let e="",i=t.length;const n="-"===t[0]?1:0;for(;i>=n+4;i-=3)e=`_${t.slice(i-3,i)}${e}`;return`${t.slice(0,i)}${e}`}function $(t,e,i,n,r,o){if(t>i||t<e){const n="bigint"==typeof e?"n":"";let r;throw r=o>3?0===e||e===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(o+1)}${n}`:`>= -(2${n} ** ${8*(o+1)-1}${n}) and < 2 ** ${8*(o+1)-1}${n}`:`>= ${e}${n} and <= ${i}${n}`,new F.ERR_OUT_OF_RANGE("value",r,t)}!function(t,e,i){j(e,"offset"),void 0!==t[e]&&void 0!==t[e+i]||W(e,t.length-(i+1))}(n,r,o)}function j(t,e){if("number"!=typeof t)throw new F.ERR_INVALID_ARG_TYPE(e,"number",t)}function W(t,e,i){if(Math.floor(t)!==t)throw j(t,i),new F.ERR_OUT_OF_RANGE(i||"offset","an integer",t);if(e<0)throw new F.ERR_BUFFER_OUT_OF_BOUNDS;throw new F.ERR_OUT_OF_RANGE(i||"offset",`>= ${i?1:0} and <= ${e}`,t)}G("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),G("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),G("ERR_OUT_OF_RANGE",(function(t,e,i){let n=`The value of "${t}" is out of range.`,r=i;return Number.isInteger(i)&&Math.abs(i)>2**32?r=H(String(i)):"bigint"==typeof i&&(r=String(i),(i>BigInt(2)**BigInt(32)||i<-(BigInt(2)**BigInt(32)))&&(r=H(r)),r+="n"),n+=` It must be ${e}. Received ${r}`,n}),RangeError);const X=/[^+/0-9A-Za-z-_]/g;function V(t,e){let i;e=e||1/0;const n=t.length;let r=null;const o=[];for(let s=0;s<n;++s){if(i=t.charCodeAt(s),i>55295&&i<57344){if(!r){if(i>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}r=i;continue}if(i<56320){(e-=3)>-1&&o.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(e-=3)>-1&&o.push(239,191,189);if(r=null,i<128){if((e-=1)<0)break;o.push(i)}else if(i<2048){if((e-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function z(t){return n.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(X,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Y(t,e,i,n){let r;for(r=0;r<n&&!(r+i>=e.length||r>=t.length);++r)e[r+i]=t[r];return r}function q(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function K(t){return t!=t}const J=function(){const t="0123456789abcdef",e=new Array(256);for(let i=0;i<16;++i){const n=16*i;for(let r=0;r<16;++r)e[n+r]=t[i]+t[r]}return e}();function Q(t){return"undefined"==typeof BigInt?Z:t}function Z(){throw new Error("BigInt not supported")}},352:(t,e)=>{"use strict";var i,n,r,o;Object.defineProperty(e,"__esModule",{value:!0}),e.VOLUME=e.RATE=e.PITCH=e.OUTPUT_FORMAT=void 0,function(t){t.AUDIO_24KHZ_48KBITRATE_MONO_MP3="audio-24khz-48kbitrate-mono-mp3",t.AUDIO_24KHZ_96KBITRATE_MONO_MP3="audio-24khz-96kbitrate-mono-mp3",t.WEBM_24KHZ_16BIT_MONO_OPUS="webm-24khz-16bit-mono-opus"}(i||(e.OUTPUT_FORMAT=i={})),function(t){t.X_LOW="x-low",t.LOW="low",t.MEDIUM="medium",t.HIGH="high",t.X_HIGH="x-high",t.DEFAULT="default"}(n||(e.PITCH=n={})),function(t){t.X_SLOW="x-slow",t.SLOW="slow",t.MEDIUM="medium",t.FAST="fast",t.X_FAST="x-fast",t.DEFAULT="default"}(r||(e.RATE=r={})),function(t){t.SILENT="silent",t.X_SOFT="x-soft",t.SOFT="soft",t.MEDIUM="medium",t.LOUD="loud",t.X_LOUD="x-LOUD",t.DEFAULT="default"}(o||(e.VOLUME=o={}))},778:function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{l(n.next(t))}catch(t){o(t)}}function a(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}l((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.EdgeTTSClient=e.ProsodyOptions=void 0;const r=i(287),o=i(352);void 0===globalThis.Buffer&&(globalThis.Buffer=r.Buffer);class s{constructor(){this.eventListeners={data:[],close:[],end:[]}}on(t,e){this.eventListeners[t].push(e)}emit(t,e){this.eventListeners[t].forEach((t=>t(e)))}}class a{constructor(){this.pitch="+0Hz",this.rate=1,this.volume=100}}e.ProsodyOptions=a;class l{constructor(t=!1){this.ws=null,this.voice=null,this.voiceLocale=null,this.outputFormat=null,this.requestQueue={},this.connectionStartTime=0,this.enableLogging=t,this.isBrowser="undefined"!=typeof window&&void 0!==window.document}log(...t){this.enableLogging&&console.log(...t)}sendMessage(t){return n(this,void 0,void 0,(function*(){var e,i;for(let t=1;t<=3&&(null===(e=this.ws)||void 0===e?void 0:e.readyState)!==WebSocket.OPEN;t++)1===t&&(this.connectionStartTime=Date.now()),this.log(`Connecting... attempt ${t}`),yield this.initWebSocket();null===(i=this.ws)||void 0===i||i.send(t)}))}initWebSocket(){this.ws=new WebSocket(l.SYNTH_URL),this.ws.binaryType="arraybuffer";let t=[];return new Promise(((e,i)=>{this.ws.onopen=()=>{this.log("Connected in",(Date.now()-this.connectionStartTime)/1e3,"seconds"),this.sendMessage(this.getConfigMessage()).then(e)},this.ws.onmessage=e=>this.handleMessage(e,t),this.ws.onclose=()=>this.handleClose(),this.ws.onerror=t=>i(`Connection Error: ${t}`)}))}handleMessage(t,e){var i;const n=r.Buffer.from(t.data),o=n.toString(),s=/X-RequestId:(.*?)\r\n/.exec(o),a=s?s[1]:"";if(o.includes("Path:turn.start"))e.length=0;else if(o.includes("Path:turn.end"))null===(i=this.requestQueue[a])||void 0===i||i.emit("end",e);else if(o.includes("Path:audio"))this.cacheAudioData(n,a);else if(o.includes("Path:audio.metadata")){const t=o.indexOf("{");e.push(JSON.parse(o.slice(t)).Metadata[0])}else this.log("Unknown Message",o)}handleClose(){this.log("Disconnected after:",(Date.now()-this.connectionStartTime)/1e3,"seconds");for(const t in this.requestQueue)this.requestQueue[t].emit("close",null)}cacheAudioData(t,e){var i;const n=(new TextEncoder).encode(l.BINARY_DELIM),r=this.findDelimiterIndex(t,n);if(-1===r)return void this.log("Delimiter not found in the buffer.");const o=r+n.length,s=t.slice(o);null===(i=this.requestQueue[e])||void 0===i||i.emit("data",s),this.log("Received audio chunk of size:",null==s?void 0:s.length)}findDelimiterIndex(t,e){for(let i=0;i<=t.length-e.length;i++){let n=!0;for(let r=0;r<e.length;r++)if(t[i+r]!==e[r]){n=!1;break}if(n)return i}return-1}getConfigMessage(){return`Content-Type:application/json; charset=utf-8\r\nPath:speech.config\r\n\r\n{\n            "context": {\n                "synthesis": {\n                    "audio": {\n                        "metadataoptions": {\n                            "sentenceBoundaryEnabled": "true",\n                            "wordBoundaryEnabled": "true"\n                        },\n                        "outputFormat": "${this.outputFormat}"\n                    }\n                }\n            }\n        }`}getVoices(){return fetch(l.VOICES_URL).then((t=>t.json())).catch((t=>Promise.reject(t)))}setMetadata(t,e,i){return n(this,void 0,void 0,(function*(){if(this.voice=t,this.outputFormat=e,this.voiceLocale=i||this.inferLocaleFromVoiceName(t),!this.voiceLocale)throw new Error("Could not infer voiceLocale from voiceName!");this.ws&&this.ws.readyState===WebSocket.OPEN||(this.connectionStartTime=Date.now(),yield this.initWebSocket())}))}inferLocaleFromVoiceName(t){const e=l.VOICE_LANG_REGEX.exec(t);return e?e[0]:null}close(){var t;null===(t=this.ws)||void 0===t||t.close()}toStream(t,e=new a){return this.sendSSMLRequest(this.buildSSML(t,e))}buildSSML(t,e){return`<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xmlns:mstts="https://www.w3.org/2001/mstts" xml:lang="${this.voiceLocale}">\n            <voice name="${this.voice}">\n                <prosody pitch="${e.pitch}" rate="${e.rate}" volume="${e.volume}">\n                    ${t}\n                </prosody>\n            </voice>\n        </speak>`}sendSSMLRequest(t){if(!this.ws)throw new Error("WebSocket not initialized. Call setMetadata first.");const e=function(){const t=new Uint8Array(16);return window.crypto.getRandomValues(t),Array.from(t,(t=>`0${t.toString(16)}`.slice(-2))).join("")}(),i=`X-RequestId:${e}\r\nContent-Type:application/ssml+xml\r\nPath:ssml\r\n\r\n${t.trim()}`,n=new s;return this.requestQueue[e]=n,this.sendMessage(i).then(),n}}e.EdgeTTSClient=l,l.OUTPUT_FORMAT=o.OUTPUT_FORMAT,l.CLIENT_TOKEN="6A5AA1D4EAFF4E9FB37E23D68491D6F4",l.VOICES_URL=`https://speech.platform.bing.com/consumer/speech/synthesize/readaloud/voices/list?trustedclienttoken=${l.CLIENT_TOKEN}`,l.SYNTH_URL=`wss://speech.platform.bing.com/consumer/speech/synthesize/readaloud/edge/v1?TrustedClientToken=${l.CLIENT_TOKEN}`,l.BINARY_DELIM="Path:audio\r\n",l.VOICE_LANG_REGEX=/\w{2}-\w{2}/},361:(t,e,i)=>{"use strict";e.cm=e.NA=e.gU=void 0;var n=i(778);Object.defineProperty(e,"gU",{enumerable:!0,get:function(){return n.EdgeTTSClient}});var r=i(778);Object.defineProperty(e,"NA",{enumerable:!0,get:function(){return r.ProsodyOptions}});var o=i(352);Object.defineProperty(e,"cm",{enumerable:!0,get:function(){return o.OUTPUT_FORMAT}})},251:(t,e)=>{e.read=function(t,e,i,n,r){var o,s,a=8*r-n-1,l=(1<<a)-1,h=l>>1,c=-7,u=i?r-1:0,f=i?-1:1,d=t[e+u];for(u+=f,o=d&(1<<-c)-1,d>>=-c,c+=a;c>0;o=256*o+t[e+u],u+=f,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=n;c>0;s=256*s+t[e+u],u+=f,c-=8);if(0===o)o=1-h;else{if(o===l)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,n),o-=h}return(d?-1:1)*s*Math.pow(2,o-n)},e.write=function(t,e,i,n,r,o){var s,a,l,h=8*o-r-1,c=(1<<h)-1,u=c>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,g=n?1:-1,p=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+u>=1?f/l:f*Math.pow(2,1-u))*l>=2&&(s++,l/=2),s+u>=c?(a=0,s=c):s+u>=1?(a=(e*l-1)*Math.pow(2,r),s+=u):(a=e*Math.pow(2,u-1)*Math.pow(2,r),s=0));r>=8;t[i+d]=255&a,d+=g,a/=256,r-=8);for(s=s<<r|a,h+=r;h>0;t[i+d]=255&s,d+=g,s/=256,h-=8);t[i+d-g]|=128*p}}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,i),o.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=i(361),e=i(396);new class{constructor(){this.ttsClient=null,this.audioContext=null,this.sourceNode=null,this.audioChunks=[],this.isPlaying=!1,this.isPaused=!1,this.currentSentenceIndex=0,this.sentences=[],this.currentStream=null,this.excludeSelectors=["select","textarea","button","label","audio","video","dialog","embed","menu",'nav:not([role="main"])',"noframes","noscript","object","script","style","svg","aside","footer","#footer",".no-read-aloud",'[aria-hidden="true"]','[role="complementary"]',"sup",'[style*="float: right"]','[style*="position: fixed"]'].join(","),this.blockElements=new Set(["p","div","h1","h2","h3","h4","h5","h6","article","section","blockquote","li","td","th","dd","dt","figcaption","pre","address"]),this.setupMessageListener()}setupMessageListener(){chrome.runtime.onMessage.addListener(((t,e,i)=>{switch(console.log("Content script received message:",t),t.action){case"startReading":this.startReading(t.voice,t.speed).then((()=>i({status:"success"}))).catch((t=>{console.error("Start reading error:",t),i({status:"error",error:t instanceof Error?t.message:String(t)})}));break;case"readSelection":const e=window.getSelection()?.toString().trim();e?this.startReadingText(e,void 0,void 0).then((()=>i({status:"success"}))).catch((t=>{console.error("Read selection error:",t),i({status:"error",error:t instanceof Error?t.message:String(t)})})):i({status:"error",error:"No text selected"});break;case"stopReading":this.stopReading(),i({status:"success"});break;case"pauseReading":this.pauseReading(),i({status:"success"});break;case"resumeReading":this.resumeReading().then((()=>i({status:"success"}))).catch((t=>{console.error("Resume reading error:",t),i({status:"error",error:t instanceof Error?t.message:String(t)})}))}return!0}))}async startReading(t,e){try{this.stopReading();const i=this.parsePageContent();if(!i)throw new Error("Could not parse page content");const n=this.formatArticleContent(i),r=await chrome.runtime.sendMessage({action:"openReader",text:n,title:i.title,metadata:{author:i.byline,siteName:i.siteName,excerpt:i.excerpt}});if("error"===r?.status)throw new Error(r.error);await this.startReadingText(i.textContent,t,e)}catch(t){const e=t instanceof Error?t.message:"An unknown error occurred";console.error("Failed to start reading:",e),chrome.runtime.sendMessage({action:"updateReaderContent",error:e})}}parsePageContent(){const t=document.cloneNode(!0);return new e.Readability(t,{keepClasses:!0,classesToPreserve:["chapter","article","section","title"]}).parse()}formatArticleContent(t){let e="";return t.title&&(e+=`<h1>${t.title}</h1>\n\n`),(t.byline||t.siteName)&&(e+='<div class="article-metadata">\n',t.byline&&(e+=`<p class="author">By ${t.byline}</p>\n`),t.siteName&&(e+=`<p class="site-name">From ${t.siteName}</p>\n`),e+="</div>\n\n"),e+=t.content,e}async startReadingText(t,e,i){try{if(!e||!i){const t=await this.getSettings();e=e||t.voice,i=i||t.speed}this.sentences=this.splitIntoSentences(t),this.currentSentenceIndex=0,this.isPaused=!1,await this.readNextSentence(e,i)}catch(t){throw console.error("TTS Error:",t),this.isPlaying=!1,t}}splitIntoSentences(t){return(t=t.replace(/\s+/g," ").replace(/([.!?])\s+/g,"$1\n").trim()).split(/\n+/).map(((t,e)=>{const i=t.trim();return{text:i,index:e,isHeading:this.isHeading(i)}})).filter((t=>t.text.length>0))}isHeading(t){return/^[A-Z0-9\s.,!?-]+$/.test(t)||/^.{1,50}:$/.test(t)||/^\d+\.\s+.{1,50}$/.test(t)}async readNextSentence(t,e){if(this.isPaused||this.currentSentenceIndex>=this.sentences.length)return void(this.currentSentenceIndex>=this.sentences.length&&this.stopReading());const i=this.sentences[this.currentSentenceIndex];try{await chrome.runtime.sendMessage({action:"updateReaderHighlight",index:this.currentSentenceIndex,text:i.text}),await this.readSentence(i.text,t,e),this.currentSentenceIndex++,await this.readNextSentence(t,e)}catch(t){const e=t instanceof Error?t.message:"An unknown error occurred";console.error("Error reading sentence:",e),this.stopReading()}}async readSentence(e,i,n){return new Promise((async(r,o)=>{try{this.ttsClient||(console.log("Creating new TTS client"),this.ttsClient=new t.gU),this.audioContext||(console.log("Creating new AudioContext"),this.audioContext=new AudioContext);const s=this.audioContext;if(!s)throw new Error("Failed to create audio context");"running"!==s.state&&(console.log("Resuming audio context"),await s.resume()),console.log("Setting TTS metadata:",{voice:i,format:t.cm.AUDIO_24KHZ_48KBITRATE_MONO_MP3}),await this.ttsClient.setMetadata(i,t.cm.AUDIO_24KHZ_48KBITRATE_MONO_MP3);const a=new t.NA;a.rate=n,console.log("TTS options:",a),this.audioChunks=[],this.isPlaying=!0;const l=[];console.log("Starting TTS stream for text:",e);const h=this.ttsClient.toStream(e,a);if(console.log("Stream created:",h),!h||"function"!=typeof h.on)throw new Error("Invalid stream object");h.on("data",(t=>{console.log("Received audio chunk:",t.length,"bytes"),l.push(t)})),h.on("end",(async()=>{if(console.log("Stream ended, total chunks:",l.length),0===l.length)return console.error("Stream ended without receiving any data"),void o(new Error("No audio data received"));try{const t=l.reduce(((t,e)=>t+e.length),0),e=new Uint8Array(t);let i=0;for(const t of l)e.set(t,i),i+=t.length;const n=await s.decodeAudioData(e.buffer);if(console.log("Audio buffer created:",{duration:n.duration,channels:n.numberOfChannels}),this.isPaused)return console.log("Playback paused, skipping audio"),void r();const o=s.createBufferSource();o.buffer=n,o.connect(s.destination),this.sourceNode=o,o.onended=()=>{console.log("Audio finished playing"),this.sourceNode=null,r()},o.start(),console.log("Started playing audio")}catch(t){console.error("Audio playback error:",t),o(t)}}))}catch(t){console.error("Error reading sentence:",t),o(t instanceof Error?t:new Error("Unknown error"))}}))}async resumeReading(){console.log("Resuming playback"),this.isPaused=!1;const t=await this.getSettings();await this.readNextSentence(t.voice,t.speed)}pauseReading(){if(console.log("Pausing playback"),this.isPaused=!0,this.sourceNode){try{this.sourceNode.stop(),this.sourceNode.disconnect()}catch(t){}this.sourceNode=null}this.audioChunks=[]}async getSettings(){return new Promise(((t,e)=>{chrome.runtime.sendMessage({action:"getSettings"},(i=>{chrome.runtime.lastError?e(chrome.runtime.lastError):t(i||{voice:"en-US-AvaNeural",speed:1})}))}))}stopReading(){if(console.log("Stopping playback"),this.isPaused=!1,this.currentSentenceIndex=0,this.isPlaying=!1,this.sourceNode){try{this.sourceNode.stop(),this.sourceNode.disconnect()}catch(t){}this.sourceNode=null}this.audioContext&&(this.audioContext.close().catch(console.error),this.audioContext=null),this.ttsClient&&(this.ttsClient.close(),this.ttsClient=null),this.audioChunks=[],chrome.runtime.sendMessage({action:"readingStopped"}).catch(console.error)}}})()})();